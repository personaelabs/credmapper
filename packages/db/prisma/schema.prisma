// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Chain {
  Zora
  Ethereum
  Optimism
}

model TransferEvent {
  transactionHash String @id
  blockNumber     BigInt
  from            String
  to              String
  tokenId         String
  contractAddress String
  chain           Chain

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@index([to])
}

model User {
  fid            Int            @id
  username       String
  displayName    String
  pfp            String
  bio            String
  followersCount Int
  cred           String[]
  PackagedCast   PackagedCast[]

  createdAt          DateTime           @default(now())
  connectedAddresses ConnectedAddress[]
}

model ConnectedAddress {
  address   String   @id
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  User User @relation(fields: [fid], references: [fid])
  fid  Int
}

model TxCount {
  address   String   @id
  txCount   Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model PackagedCast {
  id                String    @id
  text              String
  timestamp         DateTime
  mentions          BigInt[]
  mentionsPositions Int[]
  embeds            String[]
  likesCount        Int       @default(0)
  recastsCount      Int       @default(0)
  repliesCount      Int       @default(0)
  hash              String
  parentUrl         String?
  deletedAt         DateTime?
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt

  user User @relation(fields: [fid], references: [fid])
  fid  Int
}
